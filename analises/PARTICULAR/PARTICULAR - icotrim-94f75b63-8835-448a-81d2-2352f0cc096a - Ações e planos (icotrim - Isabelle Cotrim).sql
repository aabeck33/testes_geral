SELECT ANALYTICS.*, CASE ANALYTICS.FGDEADLINE WHEN 1 THEN '#{100900}' WHEN 2 THEN '#{201639}' WHEN 3 THEN '#{100899}' END AS NMDEADLINE FROM (SELECT TMCPLAN.CDGENACT_P AS CDACTIVITYOWNER, TMCPLAN.CDGENACT_P AS CDGENACTIONPLAN, TMCPLAN.ID_P AS IDACTIONPLAN, TMCPLAN.NM_P AS NMACTIONPLAN, TMCPLAN.DTSTARTPLAN_P AS DTSTARTPLANACTIONPLAN, TMCPLAN.DTFINISHPLAN_P AS DTFINISHPLANACTIONPLAN, TMCPLAN.DTSTART_P AS DTSTARTACTIONPLAN, TMCPLAN.DTFINISH_P AS DTFINISHACTIONPLAN, TMCPLAN.CDRESP_P AS CDACTIONPLANRESP, TMCPLAN.IDRESP_P AS IDACTIONPLANRESP, TMCPLAN.NMRESP_P AS NMACTIONPLANRESP, TMCPLAN.FGSTATUS_P AS FGSTATUSACTIONPLAN, TMCPLAN.FGOBJECT, TMCPLAN.FGOBJECT AS FGOBJECT2, TMCPLAN.CDACTIONPLAN, TMCPLAN.CDACTIONPLANTYPE, CASE WHEN TMCPLAN.FGSTATUS_P=1 OR TMCPLAN.FGSTATUS_P=2 THEN CASE WHEN (TMCPLAN.DTSTARTPLAN_P IS NOT NULL AND TMCPLAN.DTSTARTPLAN_P < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND TMCPLAN.DTSTARTPLAN_P=<!%TODAY%> AND TMCPLAN.QTTIMESTARTPLAN_P < CAST((datepart(minute, getdate()) + datepart(hour, getdate()) * 60) AS NUMERIC(10))) THEN 3 WHEN (TMCPLAN.DTSTARTPLAN_P IS NULL OR TMCPLAN.DTSTARTPLAN_P >= <!%TODAY%>) THEN 1 END WHEN TMCPLAN.FGSTATUS_P=3 OR TMCPLAN.FGSTATUS_P=13 THEN CASE WHEN (TMCPLAN.DTSTART_P IS NULL AND ((SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=102)=2)) THEN CASE WHEN (TMCPLAN.DTSTARTPLAN_P < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTSTARTPLAN_P=<!%TODAY%>) AND (TMCPLAN.QTTIMESTARTPLAN_P < CAST((datepart(minute, getdate()) + datepart(hour, getdate()) * 60) AS NUMERIC(10)))) THEN 3 WHEN (TMCPLAN.DTSTARTPLAN_P > (SELECT dbo.SEF_DTEND_WK_DAYS_PERIOD(convert(datetime,<!%TODAY%>), 6, TMCPLAN.CDCALENDAR)/*FROM*/)) THEN 1 ELSE 2 END WHEN (TMCPLAN.DTSTART_P IS NOT NULL AND TMCPLAN.DTFINISH_P IS NULL AND ((SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=102)=2)) THEN CASE WHEN (TMCPLAN.DTFINISHPLAN_P < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTSTARTPLAN_P=<!%TODAY%>) AND (TMCPLAN.QTTIMESTARTPLAN_P < TMCPLAN.QTTIMESTART_P)) THEN 3 WHEN (TMCPLAN.DTFINISHPLAN_P > (SELECT dbo.SEF_DTEND_WK_DAYS_PERIOD(convert(datetime,<!%TODAY%>), 6, TMCPLAN.CDCALENDAR)/*FROM*/)) THEN 1 ELSE 2 END WHEN (TMCPLAN.DTFINISH_P IS NOT NULL) THEN CASE WHEN (TMCPLAN.DTFINISH_P <= TMCPLAN.DTFINISHPLAN_P) THEN 1 WHEN (TMCPLAN.DTFINISH_P > TMCPLAN.DTFINISHPLAN_P)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTFINISHPLAN_P=TMCPLAN.DTFINISH_P) AND (TMCPLAN.QTTIMEFINISHPLAN_P < TMCPLAN.QTTIMEFINISH_P)) THEN 3 END WHEN (TMCPLAN.DTFINISH_P IS NULL AND ((SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=102)=1)) THEN CASE WHEN (TMCPLAN.DTFINISHPLAN_P < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTFINISHPLAN_P=<!%TODAY%>) AND (TMCPLAN.QTTIMEFINISHPLAN_P < CAST((datepart(minute, getdate()) + datepart(hour, getdate()) * 60) AS NUMERIC(10)))) THEN 3 WHEN (TMCPLAN.DTFINISHPLAN_P > (SELECT dbo.SEF_DTEND_WK_DAYS_PERIOD(convert(datetime,<!%TODAY%>), 6, TMCPLAN.CDCALENDAR)/*FROM*/)) THEN 1 ELSE 2 END END WHEN TMCPLAN.FGSTATUS_P=5 OR TMCPLAN.FGSTATUS_P=4 THEN CASE WHEN (TMCPLAN.DTFINISHPLAN_P < TMCPLAN.DTFINISH_P) OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTFINISHPLAN_P=TMCPLAN.DTFINISH_P) AND (TMCPLAN.QTTIMEFINISHPLAN_P < TMCPLAN.QTTIMEFINISH_P)) THEN 3 WHEN (TMCPLAN.DTSTARTPLAN_P IS NULL OR TMCPLAN.DTFINISH_P <= TMCPLAN.DTFINISHPLAN_P) THEN 1 ELSE 3 END END AS FGDEADLINEPLAN, TMCPLAN.CDGENACTIVITY AS CDACTIVITY, TMCPLAN.CDGENACTIVITY, TMCPLAN.IDACTIVITY, TMCPLAN.NMACTIVITY, TMCPLAN.DTSTARTPLAN, TMCPLAN.DTFINISHPLAN, TMCPLAN.DTSTART, TMCPLAN.DTFINISH, TMCPLAN.VLPERCENTAGEM, TMCPLAN.CDUSER AS CDTASKRESP, TMCPLAN.CDEXTERNALUSER, CASE WHEN TMCPLAN.CDEXTERNALUSER IS NULL THEN TMCPLAN.IDUSER ELSE ADEXTUSR.IDUSER END AS IDTASKRESP, CASE WHEN TMCPLAN.CDEXTERNALUSER IS NULL THEN TMCPLAN.NMUSER ELSE ADEXTUSR.NMUSER END AS NMTASKRESP, TMCPLAN.FGSTATUS, TMCPLAN.CDTASK, TMCPLAN.CDTASKTYPE, CASE WHEN TMCPLAN.FGSTATUS=1 OR TMCPLAN.FGSTATUS=2 THEN CASE WHEN (TMCPLAN.FGIMMEDIATEACTION=2 OR TMCPLAN.FGIMMEDIATEACTION IS NULL) THEN CASE WHEN (TMCPLAN.DTSTARTPLAN IS NOT NULL AND TMCPLAN.DTSTARTPLAN < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND TMCPLAN.DTSTARTPLAN=<!%TODAY%> AND TMCPLAN.QTTIMESTARTPLAN < CAST((datepart(minute, getdate()) + datepart(hour, getdate()) * 60) AS NUMERIC(10))) THEN 3 WHEN (TMCPLAN.DTSTARTPLAN IS NULL OR TMCPLAN.DTSTARTPLAN >= <!%TODAY%>) THEN 1 END ELSE 1 END WHEN TMCPLAN.FGSTATUS=3 OR TMCPLAN.FGSTATUS=13 THEN CASE WHEN (TMCPLAN.DTSTART IS NULL AND ((SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=102)=2)) THEN CASE WHEN (TMCPLAN.DTSTARTPLAN < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTSTARTPLAN=<!%TODAY%>) AND (TMCPLAN.QTTIMESTARTPLAN < CAST((datepart(minute, getdate()) + datepart(hour, getdate()) * 60) AS NUMERIC(10)))) THEN 3 WHEN (TMCPLAN.DTSTARTPLAN > (SELECT dbo.SEF_DTEND_WK_DAYS_PERIOD(convert(datetime,<!%TODAY%>), 6, TMCPLAN.CDCALENDAR)/*FROM*/)) THEN 1 ELSE 2 END WHEN (TMCPLAN.DTSTART IS NOT NULL AND TMCPLAN.DTFINISH IS NULL AND ((SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=102)=2)) THEN CASE WHEN (TMCPLAN.DTFINISHPLAN < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTSTARTPLAN=<!%TODAY%>) AND (TMCPLAN.QTTIMESTARTPLAN < TMCPLAN.QTTIMESTART)) THEN 3 WHEN (TMCPLAN.DTFINISHPLAN > (SELECT dbo.SEF_DTEND_WK_DAYS_PERIOD(convert(datetime,<!%TODAY%>), 6, TMCPLAN.CDCALENDAR)/*FROM*/)) THEN 1 ELSE 2 END WHEN (TMCPLAN.DTFINISH IS NOT NULL) THEN CASE WHEN (TMCPLAN.DTFINISH <= TMCPLAN.DTFINISHPLAN) THEN 1 WHEN (TMCPLAN.DTFINISH > TMCPLAN.DTFINISHPLAN)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTFINISHPLAN=TMCPLAN.DTFINISH) AND (TMCPLAN.QTTIMEFINISHPLAN < TMCPLAN.QTTIMEFINISH)) THEN 3 END WHEN (TMCPLAN.DTFINISH IS NULL AND ((SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=102)=1)) THEN CASE WHEN (TMCPLAN.DTFINISHPLAN < <!%TODAY%>)OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTFINISHPLAN=<!%TODAY%>) AND (TMCPLAN.QTTIMEFINISHPLAN < CAST((datepart(minute, getdate()) + datepart(hour, getdate()) * 60) AS NUMERIC(10)))) THEN 3 WHEN (TMCPLAN.DTFINISHPLAN > (SELECT dbo.SEF_DTEND_WK_DAYS_PERIOD(convert(datetime,<!%TODAY%>), 6, TMCPLAN.CDCALENDAR)/*FROM*/)) THEN 1 ELSE 2 END END WHEN TMCPLAN.FGSTATUS=5 OR TMCPLAN.FGSTATUS=4 THEN CASE WHEN (TMCPLAN.DTFINISHPLAN < TMCPLAN.DTFINISH) OR (EXISTS (SELECT VLPARAM FROM ADPARAMS WHERE CDISOSYSTEM=174 AND CDPARAM=203 AND VLPARAM=1) AND (TMCPLAN.DTFINISHPLAN=TMCPLAN.DTFINISH) AND (TMCPLAN.QTTIMEFINISHPLAN < TMCPLAN.QTTIMEFINISH)) THEN 3 WHEN (TMCPLAN.DTSTARTPLAN IS NULL OR TMCPLAN.DTFINISH <= TMCPLAN.DTFINISHPLAN) THEN 1 ELSE 3 END END AS FGDEADLINE, 1 AS QTD, P.IDOBJECT, P.IDPROCESS, P.NMPROCESS, P.FGSTATUS AS FGSTATUSOCCURRENCE, WFGNT.IDGENTYPE AS GENTYPEOCCURRENCE, CASE P.FGSTATUS WHEN 1 THEN 'Andamento' WHEN 2 THEN 'Suspenso' WHEN 3 THEN 'Cancelado' WHEN 4 THEN 'Encerrado' WHEN 5 THEN 'Bloqueado para edição' END AS IDSITUATION, CASE WHEN P.FGCONCLUDEDSTATUS IS NOT NULL THEN (CASE WHEN P.FGCONCLUDEDSTATUS=1 THEN 1 WHEN P.FGCONCLUDEDSTATUS=2 THEN 3 END) ELSE (CASE WHEN (( P.DTESTIMATEDFINISH > (DATEADD(DAY, COALESCE((SELECT QTDAYS FROM ADMAILTASKEXEC WHERE CDMAILTASKEXEC=(SELECT TASK.CDAHEAD FROM ADMAILTASKREL TASK WHERE TASK.CDMAILTASKREL=(SELECT TBL.CDMAILTASKSETTINGS FROM CONOTIFICATION TBL))),1), CAST(<!%TODAY%> AS DATETIME)))) OR (P.DTESTIMATEDFINISH IS NULL)) THEN 1 WHEN (( P.DTESTIMATEDFINISH=CAST(<!%TODAY%> AS DATETIME) AND P.NRTIMEESTFINISH >= 467) OR (P.DTESTIMATEDFINISH > CAST(<!%TODAY%> AS DATETIME))) THEN 2 ELSE 3 END) END AS FGDEADLINEOCCURRENCE, CASE WHEN P.FGCONCLUDEDSTATUS IS NOT NULL THEN (CASE WHEN P.FGCONCLUDEDSTATUS=1 THEN 'Em dia' WHEN P.FGCONCLUDEDSTATUS=2 THEN 'Em atraso' END) ELSE (CASE WHEN (( P.DTESTIMATEDFINISH > (DATEADD(DAY, COALESCE((SELECT QTDAYS FROM ADMAILTASKEXEC WHERE CDMAILTASKEXEC=(SELECT TASK.CDAHEAD FROM ADMAILTASKREL TASK WHERE TASK.CDMAILTASKREL=(SELECT TBL.CDMAILTASKSETTINGS FROM CONOTIFICATION TBL))),1), CAST(<!%TODAY%> AS DATETIME)))) OR (P.DTESTIMATEDFINISH IS NULL)) THEN 'Em dia' WHEN (( P.DTESTIMATEDFINISH=CAST(<!%TODAY%> AS DATETIME) AND P.NRTIMEESTFINISH >= 467) OR (P.DTESTIMATEDFINISH > CAST(<!%TODAY%> AS DATETIME))) THEN 'Próximo do vencimento' ELSE 'Em atraso' END) END AS NMDEADLINEOCCURRENCE, CONVERT( DATETIME, P.DTSTART + ' ' + P.TMSTART, 120) AS DTSTARTOCCURRENCE, CONVERT( DATETIME, P.DTFINISH + ' ' + P.TMFINISH, 120) AS DTFINISHOCCURRENCE, TMCPLAN.IDGENTYPE, TMCPLAN.NMGENTYPE, GNCC.MNCOSTPROG, GNCC.MNCOSTREAL, CASE WHEN TMCPLAN.FGSTATUS=1 THEN '#{100470}' WHEN TMCPLAN.FGSTATUS=2 THEN '#{200135}' WHEN TMCPLAN.FGSTATUS=3 THEN '#{200002}' WHEN TMCPLAN.FGSTATUS=4 AND TMCPLAN.FGPLAN=1 THEN '#{218317}' WHEN TMCPLAN.FGSTATUS=4 AND TMCPLAN.FGPLAN=2 THEN '#{100476}' WHEN TMCPLAN.FGSTATUS=5 THEN '#{101237}' WHEN TMCPLAN.FGSTATUS=6 THEN '#{104230}' END AS NMACTSTATUS, ADT.NMTEAM AS IDNMTEAM FROM (SELECT GNAPLANO.CDGENACTIVITY AS CDGLUE, GNAPLANO.CDACTACCESSROLE, GGTP.CDTYPEROLE, GNAPLANO.CDCALENDAR, GNAPLANO.CDGENACTIVITY AS CDGENACT_P, GNAPLANO.IDACTIVITY AS ID_P, GNAPLANO.NMACTIVITY AS NM_P, GNAPLANO.FGSTATUS AS FGSTATUS_P, GNAPLANO.DTSTARTPLAN AS DTSTARTPLAN_P, GNAPLANO.DTFINISHPLAN AS DTFINISHPLAN_P, GNAPLANO.DTSTART AS DTSTART_P, GNAPLANO.DTFINISH AS DTFINISH_P, GNAPLANO.QTTIMESTARTPLAN AS QTTIMESTARTPLAN_P, GNAPLANO.QTTIMEFINISHPLAN AS QTTIMEFINISHPLAN_P, GNAPLANO.QTTIMESTART AS QTTIMESTART_P, GNAPLANO.QTTIMEFINISH AS QTTIMEFINISH_P, ADU_P.CDUSER AS CDRESP_P, ADU_P.IDUSER AS IDRESP_P, ADU_P.NMUSER AS NMRESP_P, GNAP.CDACTIONPLAN, GNAP.CDACTIONPLANTYPE, GNAP.FGOBJECT, GNA.CDGENACTIVITY, GNA.IDACTIVITY, GNA.NMACTIVITY, GNA.FGSTATUS, GNA.DTSTARTPLAN, GNA.DTFINISHPLAN, GNA.DTSTART, GNA.DTFINISH, GNA.QTTIMESTARTPLAN, GNA.QTTIMEFINISHPLAN, GNA.QTTIMESTART, GNA.QTTIMEFINISH, GNA.VLPERCENTAGEM, GNA.CDCOSTCONFIG, GNA.CDEXTERNALUSER, GNA.CDTEAM, GNT.CDTASK, GNT.FGIMMEDIATEACTION, GNT.CDTASKTYPE, GGT.IDGENTYPE, GGT.NMGENTYPE, ADU.CDUSER, ADU.IDUSER, ADU.NMUSER, 1 AS FGPLAN FROM GNACTIONPLAN GNAP INNER JOIN GNACTIVITY GNAPLANO ON GNAPLANO.CDGENACTIVITY=GNAP.CDGENACTIVITY AND GNAPLANO.CDISOSYSTEM=174 INNER JOIN GNGENTYPE GGTP ON GGTP.CDGENTYPE=GNAP.CDACTIONPLANTYPE INNER JOIN GNACTIVITY GNA ON GNA.CDACTIVITYOWNER=GNAPLANO.CDGENACTIVITY AND GNA.CDISOSYSTEM=174 INNER JOIN GNTASK GNT ON GNT.CDGENACTIVITY=GNA.CDGENACTIVITY INNER JOIN ADUSER ADU_P ON ADU_P.CDUSER=GNAPLANO.CDUSERACTIVRESP LEFT OUTER JOIN GNGENTYPE GGT ON GGT.CDGENTYPE=GNT.CDTASKTYPE LEFT OUTER JOIN ADUSER ADU ON ADU.CDUSER=GNA.CDUSER WHERE GNAP.FGMODEL=2 AND (GGT.CDTYPEROLE IS NULL OR EXISTS (SELECT NULL FROM (SELECT CHKUSRPERMTYPEROLE.CDTYPEROLE AS CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER FROM (SELECT PM.FGPERMISSIONTYPE, PM.CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM WHERE 1=1 AND PM.CDUSER <> -1 AND PM.CDPERMISSION=5 /* Nao retirar este comentario */UNION ALL SELECT PM.FGPERMISSIONTYPE, US.CDUSER AS CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM CROSS JOIN ADUSER US WHERE 1=1 AND PM.CDUSER=-1 AND US.FGUSERENABLED=1 AND PM.CDPERMISSION=5) CHKUSRPERMTYPEROLE GROUP BY CHKUSRPERMTYPEROLE.CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER HAVING MAX(CHKUSRPERMTYPEROLE.FGPERMISSIONTYPE)=1) CHKPERMTYPEROLE WHERE CHKPERMTYPEROLE.CDTYPEROLE=GGT.CDTYPEROLE AND (CHKPERMTYPEROLE.CDUSER=17260 OR 17260=-1))) UNION ALL SELECT GNA.CDGENACTIVITY AS CDGLUE, GNA.CDACTACCESSROLE, GGT.CDTYPEROLE, GNA.CDCALENDAR, NULL AS CDGENACT_P, NULL AS ID_P, NULL AS NM_P, NULL AS FGSTATUS_P, NULL AS DTSTARTPLAN_P, NULL AS DTFINISHPLAN_P, NULL AS DTSTART_P, NULL AS DTFINISH_P, NULL AS QTTIMESTARTPLAN_P, NULL AS QTTIMEFINISHPLAN_P, NULL AS QTTIMESTART_P, NULL AS QTTIMEFINISH_P, NULL AS CDRESP_P, NULL AS IDRESP_P, NULL AS NMRESP_P, NULL AS CDACTIONPLAN, NULL AS CDACTIONPLANTYPE, GNT.FGOBJECT, GNA.CDGENACTIVITY, GNA.IDACTIVITY, GNA.NMACTIVITY, GNA.FGSTATUS, GNA.DTSTARTPLAN, GNA.DTFINISHPLAN, GNA.DTSTART, GNA.DTFINISH, GNA.QTTIMESTARTPLAN, GNA.QTTIMEFINISHPLAN, GNA.QTTIMESTART, GNA.QTTIMEFINISH, GNA.VLPERCENTAGEM, GNA.CDCOSTCONFIG, GNA.CDEXTERNALUSER, GNA.CDTEAM, GNT.CDTASK, GNT.FGIMMEDIATEACTION, GNT.CDTASKTYPE, GGT.IDGENTYPE, GGT.NMGENTYPE, ADU.CDUSER, ADU.IDUSER, ADU.NMUSER, 2 AS FGPLAN FROM GNTASK GNT INNER JOIN GNACTIVITY GNA ON GNA.CDGENACTIVITY=GNT.CDGENACTIVITY AND GNA.CDISOSYSTEM=174 LEFT OUTER JOIN GNGENTYPE GGT ON GGT.CDGENTYPE=GNT.CDTASKTYPE LEFT OUTER JOIN ADUSER ADU ON ADU.CDUSER=GNA.CDUSER WHERE GNA.CDACTIVITYOWNER IS NULL) TMCPLAN LEFT OUTER JOIN ADALLUSERS ADEXTUSR ON (ADEXTUSR.CDEXTERNALUSER=TMCPLAN.CDEXTERNALUSER) INNER JOIN GNASSOCACTIONPLAN INGNAP ON INGNAP.CDACTIONPLAN=TMCPLAN.CDGLUE INNER JOIN GNACTIVITY WFGNAT ON WFGNAT.CDASSOC=INGNAP.CDASSOC AND WFGNAT.CDISOSYSTEM=15 INNER JOIN WFPROCESS P ON P.CDGENACTIVITY=WFGNAT.CDGENACTIVITY INNER JOIN INOCCURRENCE INO ON INO.IDWORKFLOW=P.IDOBJECT AND INO.FGOCCURRENCETYPE=2 INNER JOIN GNGENTYPE WFGNT ON WFGNT.CDGENTYPE=INO.CDOCCURRENCETYPE INNER JOIN (SELECT DISTINCT Z.IDOBJECT FROM (SELECT P.IDOBJECT FROM WFPROCESS P INNER JOIN (SELECT PERM.USERCD, PERM.IDPROCESS, MIN(PERM.FGPERMISSION) AS FGPERMISSION FROM (SELECT WF.FGPERMISSION, WF.IDPROCESS, TM.CDUSER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF INNER JOIN ADTEAMUSER TM ON WF.CDTEAM=TM.CDTEAM WHERE 1=1 AND WF.FGACCESSTYPE=1 AND TM.CDUSER=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, UDP.CDUSER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF INNER JOIN ADUSERDEPTPOS UDP ON WF.CDDEPARTMENT=UDP.CDDEPARTMENT WHERE 1=1 AND WF.FGACCESSTYPE=2 AND UDP.CDUSER=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, UDP.CDUSER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF INNER JOIN ADUSERDEPTPOS UDP ON WF.CDDEPARTMENT=UDP.CDDEPARTMENT AND WF.CDPOSITION=UDP.CDPOSITION WHERE 1=1 AND WF.FGACCESSTYPE=3 AND UDP.CDUSER=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, UDP.CDUSER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF INNER JOIN ADUSERDEPTPOS UDP ON WF.CDPOSITION=UDP.CDPOSITION WHERE 1=1 AND WF.FGACCESSTYPE=4 AND UDP.CDUSER=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, WF.CDUSER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF WHERE 1=1 AND WF.FGACCESSTYPE=5 AND WF.CDUSER=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, US.CDUSER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF CROSS JOIN ADUSER US WHERE 1=1 AND WF.FGACCESSTYPE=6 AND US.CDUSER=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, RL.CDUSER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF INNER JOIN ADUSERROLE RL ON RL.CDROLE=WF.CDROLE WHERE 1=1 AND WF.FGACCESSTYPE=7 AND RL.CDUSER=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, WFP.CDUSERSTART AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF INNER JOIN WFPROCESS WFP ON WFP.IDOBJECT=WF.IDPROCESS WHERE 1=1 AND WF.FGACCESSTYPE=30 AND WFP.CDUSERSTART=17260 AND WF.FGACCESSEXCEPTION IS NULL UNION ALL SELECT WF.FGPERMISSION, WF.IDPROCESS, US.CDLEADER AS USERCD, WF.CDACCESSLIST FROM WFPROCSECURITYLIST WF INNER JOIN WFPROCESS WFP ON WFP.IDOBJECT=WF.IDPROCESS INNER JOIN ADUSER US ON US.CDUSER=WFP.CDUSERSTART WHERE 1=1 AND WF.FGACCESSTYPE=31 AND US.CDLEADER=17260 AND WF.FGACCESSEXCEPTION IS NULL) PERM INNER JOIN WFPROCSECURITYCTRL GNASSOC ON GNASSOC.CDACCESSLIST=PERM.CDACCESSLIST AND GNASSOC.IDPROCESS=PERM.IDPROCESS WHERE 1=1 AND GNASSOC.CDACCESSROLEFIELD=501 GROUP BY PERM.USERCD, PERM.IDPROCESS) PERMISSION ON PERMISSION.IDPROCESS=P.IDOBJECT WHERE 1=1 AND PERMISSION.FGPERMISSION=1 AND P.FGSTATUS <= 5 AND (P.FGMODELWFSECURITY IS NULL OR P.FGMODELWFSECURITY=0) UNION ALL SELECT T.IDOBJECT FROM (SELECT PERM.IDOBJECT, MIN(PERM.FGPERMISSION) AS FGPERMISSION FROM (SELECT WFP.IDOBJECT, PMA.FGUSETYPEACCESS, PERM1.FGPERMISSION FROM (SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, TM.CDUSER AS USERCD FROM PMACTTYPESECURLIST PM INNER JOIN ADTEAMUSER TM ON PM.CDTEAM=TM.CDTEAM WHERE 1=1 AND PM.FGACCESSTYPE=1 AND TM.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, UDP.CDUSER AS USERCD FROM PMACTTYPESECURLIST PM INNER JOIN ADUSERDEPTPOS UDP ON PM.CDDEPARTMENT=UDP.CDDEPARTMENT WHERE 1=1 AND PM.FGACCESSTYPE=2 AND UDP.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, UDP.CDUSER AS USERCD FROM PMACTTYPESECURLIST PM INNER JOIN ADUSERDEPTPOS UDP ON PM.CDDEPARTMENT=UDP.CDDEPARTMENT AND PM.CDPOSITION=UDP.CDPOSITION WHERE 1=1 AND PM.FGACCESSTYPE=3 AND UDP.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, UDP.CDUSER AS USERCD FROM PMACTTYPESECURLIST PM INNER JOIN ADUSERDEPTPOS UDP ON PM.CDPOSITION=UDP.CDPOSITION WHERE 1=1 AND PM.FGACCESSTYPE=4 AND UDP.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, PM.CDUSER AS USERCD FROM PMACTTYPESECURLIST PM WHERE 1=1 AND PM.FGACCESSTYPE=5 AND PM.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, US.CDUSER AS USERCD FROM PMACTTYPESECURLIST PM CROSS JOIN ADUSER US WHERE 1=1 AND PM.FGACCESSTYPE=6 AND US.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, RL.CDUSER AS USERCD FROM PMACTTYPESECURLIST PM INNER JOIN ADUSERROLE RL ON RL.CDROLE=PM.CDROLE WHERE 1=1 AND PM.FGACCESSTYPE=7 AND RL.CDUSER=17260) PERM1 INNER JOIN PMACTTYPESECURCTRL GNASSOC ON PERM1.CDACCESSLIST=GNASSOC.CDACCESSLIST AND PERM1.CDACTTYPE=GNASSOC.CDACTTYPE INNER JOIN PMACCESSROLEFIELD GNCTRL ON GNASSOC.CDACCESSROLEFIELD=GNCTRL.CDACCESSROLEFIELD INNER JOIN PMACCESSROLEFIELD GNCTRL_F ON GNCTRL.CDRELATEDFIELD=GNCTRL_F.CDACCESSROLEFIELD INNER JOIN PMACTIVITY PMA ON PERM1.CDACTTYPE=PMA.CDACTTYPE INNER JOIN WFPROCESS WFP ON PMA.CDACTIVITY=WFP.CDPROCESSMODEL WHERE 1=1 AND GNCTRL_F.CDRELATEDFIELD=501 AND WFP.FGSTATUS <= 5 AND PMA.FGUSETYPEACCESS=1 AND WFP.FGMODELWFSECURITY=1 UNION ALL SELECT WFP.IDOBJECT, PMA.FGUSETYPEACCESS, PERM2.FGPERMISSION FROM (SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, PMA.CDCREATEDBY AS USERCD FROM PMACTTYPESECURLIST PM INNER JOIN PMACTIVITY PMA ON PM.CDACTTYPE=PMA.CDACTTYPE WHERE 1=1 AND PM.FGACCESSTYPE=8 AND PMA.CDCREATEDBY=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, DEP2.CDUSER FROM PMACTTYPESECURLIST PM INNER JOIN PMACTIVITY PMA ON PM.CDACTTYPE=PMA.CDACTTYPE INNER JOIN ADUSERDEPTPOS DEP1 ON DEP1.CDUSER=PMA.CDCREATEDBY INNER JOIN ADUSERDEPTPOS DEP2 ON DEP2.CDDEPARTMENT=DEP1.CDDEPARTMENT WHERE 1=1 AND PM.FGACCESSTYPE=9 AND DEP2.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, DEP2.CDUSER FROM PMACTTYPESECURLIST PM INNER JOIN PMACTIVITY PMA ON PM.CDACTTYPE=PMA.CDACTTYPE INNER JOIN ADUSERDEPTPOS DEP1 ON DEP1.CDUSER=PMA.CDCREATEDBY INNER JOIN ADUSERDEPTPOS DEP2 ON DEP2.CDDEPARTMENT=DEP1.CDDEPARTMENT AND DEP2.CDPOSITION=DEP1.CDPOSITION WHERE 1=1 AND PM.FGACCESSTYPE=10 AND DEP2.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, DEP2.CDUSER FROM PMACTTYPESECURLIST PM INNER JOIN PMACTIVITY PMA ON PM.CDACTTYPE=PMA.CDACTTYPE INNER JOIN ADUSERDEPTPOS DEP1 ON DEP1.CDUSER=PMA.CDCREATEDBY INNER JOIN ADUSERDEPTPOS DEP2 ON DEP2.CDPOSITION=DEP1.CDPOSITION WHERE 1=1 AND PM.FGACCESSTYPE=11 AND DEP2.CDUSER=17260 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, US.CDLEADER FROM PMACTTYPESECURLIST PM INNER JOIN PMACTIVITY PMA ON PM.CDACTTYPE=PMA.CDACTTYPE INNER JOIN ADUSER US ON US.CDUSER=PMA.CDCREATEDBY WHERE 1=1 AND PM.FGACCESSTYPE=12 AND US.CDLEADER=17260) PERM2 INNER JOIN PMACTTYPESECURCTRL GNASSOC ON PERM2.CDACCESSLIST=GNASSOC.CDACCESSLIST AND PERM2.CDACTTYPE=GNASSOC.CDACTTYPE INNER JOIN PMACCESSROLEFIELD GNCTRL ON GNASSOC.CDACCESSROLEFIELD=GNCTRL.CDACCESSROLEFIELD INNER JOIN PMACCESSROLEFIELD GNCTRL_F ON GNCTRL.CDRELATEDFIELD=GNCTRL_F.CDACCESSROLEFIELD INNER JOIN PMACTIVITY PMA ON PERM2.CDACTTYPE=PMA.CDACTTYPE INNER JOIN WFPROCESS WFP ON PMA.CDACTIVITY=WFP.CDPROCESSMODEL WHERE 1=1 AND GNCTRL_F.CDRELATEDFIELD=501 AND WFP.FGSTATUS <= 5 AND PMA.FGUSETYPEACCESS=1 AND WFP.FGMODELWFSECURITY=1 UNION ALL SELECT PERM3.IDOBJECT, PMA.FGUSETYPEACCESS, PERM3.FGPERMISSION FROM (SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, WFP.CDUSERSTART AS USERCD, WFP.IDOBJECT FROM PMACTTYPESECURLIST PM INNER JOIN PMACTIVITY PMA ON PM.CDACTTYPE=PMA.CDACTTYPE INNER JOIN WFPROCESS WFP ON PMA.CDACTIVITY=WFP.CDPROCESSMODEL WHERE 1=1 AND PM.FGACCESSTYPE=30 AND WFP.CDUSERSTART=17260 AND WFP.FGSTATUS <= 5 AND WFP.FGMODELWFSECURITY=1 UNION ALL SELECT PM.FGPERMISSION, PM.CDACTTYPE, PM.CDACCESSLIST, US.CDLEADER AS USERCD, WFP.IDOBJECT FROM PMACTTYPESECURLIST PM INNER JOIN PMACTIVITY PMA ON PM.CDACTTYPE=PMA.CDACTTYPE INNER JOIN WFPROCESS WFP ON PMA.CDACTIVITY=WFP.CDPROCESSMODEL INNER JOIN ADUSER US ON US.CDUSER=WFP.CDUSERSTART WHERE 1=1 AND PM.FGACCESSTYPE=31 AND US.CDLEADER=17260 AND WFP.FGSTATUS <= 5 AND WFP.FGMODELWFSECURITY=1) PERM3 INNER JOIN PMACTTYPESECURCTRL GNASSOC ON PERM3.CDACCESSLIST=GNASSOC.CDACCESSLIST AND PERM3.CDACTTYPE=GNASSOC.CDACTTYPE INNER JOIN PMACCESSROLEFIELD GNCTRL ON GNASSOC.CDACCESSROLEFIELD=GNCTRL.CDACCESSROLEFIELD INNER JOIN PMACCESSROLEFIELD GNCTRL_F ON GNCTRL.CDRELATEDFIELD=GNCTRL_F.CDACCESSROLEFIELD INNER JOIN PMACTIVITY PMA ON PERM3.CDACTTYPE=PMA.CDACTTYPE WHERE 1=1 AND GNCTRL_F.CDRELATEDFIELD=501 AND PMA.FGUSETYPEACCESS=1) PERM WHERE 1=1 GROUP BY PERM.IDOBJECT) T WHERE 1=1 AND T.FGPERMISSION=1 UNION ALL SELECT T.IDOBJECT FROM (SELECT MIN(PERM99.FGPERMISSION) AS FGPERMISSION, PERM99.IDOBJECT FROM (SELECT WFP.IDOBJECT, PERM1.FGPERMISSION FROM (SELECT PP.FGPERMISSION, PP.CDPROC, PP.CDACCESSLIST, TM.CDUSER AS USERCD FROM PMPROCACCESSLIST PP INNER JOIN ADTEAMUSER TM ON PP.CDTEAM=TM.CDTEAM WHERE 1=1 AND PP.FGACCESSTYPE=1 AND TM.CDUSER=17260 UNION ALL SELECT PP.FGPERMISSION, PP.CDPROC, PP.CDACCESSLIST, UDP.CDUSER AS USERCD FROM PMPROCACCESSLIST PP INNER JOIN ADUSERDEPTPOS UDP ON PP.CDDEPARTMENT=UDP.CDDEPARTMENT WHERE 1=1 AND PP.FGACCESSTYPE=2 AND UDP.CDUSER=17260 UNION ALL SELECT PP.FGPERMISSION, PP.CDPROC, PP.CDACCESSLIST, UDP.CDUSER AS USERCD FROM PMPROCACCESSLIST PP INNER JOIN ADUSERDEPTPOS UDP ON PP.CDDEPARTMENT=UDP.CDDEPARTMENT AND PP.CDPOSITION=UDP.CDPOSITION WHERE 1=1 AND PP.FGACCESSTYPE=3 AND UDP.CDUSER=17260 UNION ALL SELECT PP.FGPERMISSION, PP.CDPROC, PP.CDACCESSLIST, UDP.CDUSER AS USERCD FROM PMPROCACCESSLIST PP INNER JOIN ADUSERDEPTPOS UDP ON PP.CDPOSITION=UDP.CDPOSITION WHERE 1=1 AND PP.FGACCESSTYPE=4 AND UDP.CDUSER=17260 UNION ALL SELECT PP.FGPERMISSION, PP.CDPROC, PP.CDACCESSLIST, PP.CDUSER AS USERCD FROM PMPROCACCESSLIST PP WHERE 1=1 AND PP.FGACCESSTYPE=5 AND PP.CDUSER=17260 UNION ALL SELECT PP.FGPERMISSION, PP.CDPROC, PP.CDACCESSLIST, US.CDUSER AS USERCD FROM PMPROCACCESSLIST PP CROSS JOIN ADUSER US WHERE 1=1 AND PP.FGACCESSTYPE=6 AND US.CDUSER=17260 UNION ALL SELECT PP.FGPERMISSION, PP.CDPROC, PP.CDACCESSLIST, RL.CDUSER AS USERCD FROM PMPROCACCESSLIST PP INNER JOIN ADUSERROLE RL ON RL.CDROLE=PP.CDROLE WHERE 1=1 AND PP.FGACCESSTYPE=7 AND RL.CDUSER=17260) PERM1 INNER JOIN PMPROCSECURITYCTRL GNASSOC ON PERM1.CDACCESSLIST=GNASSOC.CDACCESSLIST AND PERM1.CDPROC=GNASSOC.CDPROC INNER JOIN PMACCESSROLEFIELD GNCTRL ON GNASSOC.CDACCESSROLEFIELD=GNCTRL.CDACCESSROLEFIELD INNER JOIN PMACTIVITY OBJ ON GNASSOC.CDPROC=OBJ.CDACTIVITY INNER JOIN WFPROCESS WFP ON WFP.CDPROCESSMODEL=PERM1.CDPROC WHERE 1=1 AND GNCTRL.CDRELATEDFIELD=501 AND (OBJ.FGUSETYPEACCESS=0 OR OBJ.FGUSETYPEACCESS IS NULL) AND WFP.FGMODELWFSECURITY=1 AND WFP.FGSTATUS <= 5 UNION ALL SELECT PERM2.IDOBJECT, PERM2.FGPERMISSION FROM (SELECT PP.FGPERMISSION, WFP.IDOBJECT, PP.CDPROC, PP.CDACCESSLIST, WFP.CDUSERSTART AS USERCD FROM PMPROCACCESSLIST PP INNER JOIN WFPROCESS WFP ON WFP.CDPROCESSMODEL=PP.CDPROC WHERE 1=1 AND PP.FGACCESSTYPE=30 AND WFP.CDUSERSTART=17260 AND WFP.FGMODELWFSECURITY=1 AND WFP.FGSTATUS <= 5 UNION ALL SELECT PP.FGPERMISSION, WFP.IDOBJECT, PP.CDPROC, PP.CDACCESSLIST, US.CDLEADER AS USERCD FROM PMPROCACCESSLIST PP INNER JOIN WFPROCESS WFP ON WFP.CDPROCESSMODEL=PP.CDPROC INNER JOIN ADUSER US ON US.CDUSER=WFP.CDUSERSTART WHERE 1=1 AND PP.FGACCESSTYPE=31 AND US.CDLEADER=17260 AND WFP.FGMODELWFSECURITY=1 AND WFP.FGSTATUS <= 5) PERM2 INNER JOIN PMPROCSECURITYCTRL GNASSOC ON PERM2.CDACCESSLIST=GNASSOC.CDACCESSLIST AND PERM2.CDPROC=GNASSOC.CDPROC INNER JOIN PMACCESSROLEFIELD GNCTRL ON GNASSOC.CDACCESSROLEFIELD=GNCTRL.CDACCESSROLEFIELD INNER JOIN PMACTIVITY OBJ ON GNASSOC.CDPROC=OBJ.CDACTIVITY WHERE 1=1 AND GNCTRL.CDRELATEDFIELD=501 AND (OBJ.FGUSETYPEACCESS=0 OR OBJ.FGUSETYPEACCESS IS NULL)) PERM99 WHERE 1=1 GROUP BY PERM99.IDOBJECT) T WHERE 1=1 AND T.FGPERMISSION=1 UNION ALL SELECT WFP.IDOBJECT FROM WFPROCESS WFP INNER JOIN WFPROCSECURITYLIST WFLIST ON WFP.IDOBJECT=WFLIST.IDPROCESS INNER JOIN WFPROCSECURITYCTRL WFCTRL ON WFLIST.CDACCESSLIST=WFCTRL.CDACCESSLIST AND WFLIST.IDPROCESS=WFCTRL.IDPROCESS  WHERE WFCTRL.CDACCESSROLEFIELD=501 AND WFLIST.CDUSER=17260 AND WFLIST.FGACCESSTYPE=5 AND WFLIST.FGACCESSEXCEPTION=1 AND WFLIST.FGPERMISSION=1 AND WFP.FGSTATUS <= 5) Z WHERE 1=1) MYPERM ON (P.IDOBJECT=MYPERM.IDOBJECT) LEFT OUTER JOIN GNCOSTCONFIG GNCC ON GNCC.CDCOSTCONFIG=TMCPLAN.CDCOSTCONFIG LEFT OUTER JOIN ADTEAM ADT ON ADT.CDTEAM=TMCPLAN.CDTEAM WHERE 1=1 AND (TMCPLAN.CDTYPEROLE IS NULL OR EXISTS (SELECT NULL FROM (SELECT CHKUSRPERMTYPEROLE.CDTYPEROLE AS CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER FROM (SELECT PM.FGPERMISSIONTYPE, PM.CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM WHERE 1=1 AND PM.CDUSER <> -1 AND PM.CDPERMISSION=5 /* Nao retirar este comentario */UNION ALL SELECT PM.FGPERMISSIONTYPE, US.CDUSER AS CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM CROSS JOIN ADUSER US WHERE 1=1 AND PM.CDUSER=-1 AND US.FGUSERENABLED=1 AND PM.CDPERMISSION=5) CHKUSRPERMTYPEROLE GROUP BY CHKUSRPERMTYPEROLE.CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER HAVING MAX(CHKUSRPERMTYPEROLE.FGPERMISSIONTYPE)=1) CHKPERMTYPEROLE WHERE CHKPERMTYPEROLE.CDTYPEROLE=TMCPLAN.CDTYPEROLE AND (CHKPERMTYPEROLE.CDUSER=17260 OR 17260=-1))) AND (TMCPLAN.CDACTACCESSROLE IS NULL OR EXISTS (SELECT NULL FROM (SELECT CHKUSRPERMTYPEROLE.CDTYPEROLE AS CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER FROM (SELECT PM.FGPERMISSIONTYPE, PM.CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM WHERE 1=1 AND PM.CDUSER <> -1 AND PM.CDPERMISSION=5 /* Nao retirar este comentario */UNION ALL SELECT PM.FGPERMISSIONTYPE, US.CDUSER AS CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM CROSS JOIN ADUSER US WHERE 1=1 AND PM.CDUSER=-1 AND US.FGUSERENABLED=1 AND PM.CDPERMISSION=5) CHKUSRPERMTYPEROLE GROUP BY CHKUSRPERMTYPEROLE.CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER HAVING MAX(CHKUSRPERMTYPEROLE.FGPERMISSIONTYPE)=1) CHKPERMTYPEROLE WHERE CHKPERMTYPEROLE.CDTYPEROLE=TMCPLAN.CDACTACCESSROLE AND (CHKPERMTYPEROLE.CDUSER=17260 OR 17260=-1))) AND INO.CDOCCURRENCETYPE IN (<!%FUNC(com.softexpert.generic.parameter.InClauseBuilder, R05HRU5UWVBF, Q0RHRU5UWVBF, Q0RHRU5UWVBFT1dORVI=,, MjI1,)%>) AND (WFGNT.CDTYPEROLE IS NULL OR EXISTS (SELECT NULL FROM (SELECT CHKUSRPERMTYPEROLE.CDTYPEROLE AS CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER FROM (SELECT PM.FGPERMISSIONTYPE, PM.CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM WHERE 1=1 AND PM.CDUSER <> -1 AND PM.CDPERMISSION=5 /* Nao retirar este comentario */UNION ALL SELECT PM.FGPERMISSIONTYPE, US.CDUSER AS CDUSER, PM.CDTYPEROLE FROM GNUSERPERMTYPEROLE PM CROSS JOIN ADUSER US WHERE 1=1 AND PM.CDUSER=-1 AND US.FGUSERENABLED=1 AND PM.CDPERMISSION=5) CHKUSRPERMTYPEROLE GROUP BY CHKUSRPERMTYPEROLE.CDTYPEROLE, CHKUSRPERMTYPEROLE.CDUSER HAVING MAX(CHKUSRPERMTYPEROLE.FGPERMISSIONTYPE)=1) CHKPERMTYPEROLE WHERE CHKPERMTYPEROLE.CDTYPEROLE=WFGNT.CDTYPEROLE AND (CHKPERMTYPEROLE.CDUSER=17260 OR 17260=-1)))) ANALYTICS
